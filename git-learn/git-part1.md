基本概念
=======================================================

版本库：维护与管理项目的修订版本和历史信息的数据库；它不仅仅提供版本库中所有文件的副本，还可以提供版本库本身的副本。

在每个版本库里都会维护一组配置文件，它和文件数据、元数据不同，在把一个版本库克隆到另一个版本库的时候配置是不随转移的；但是git必须对配置进行管理与检查。

版本库维护的数据结构：对象库和索引（相应在.git）

git对象库：包含原始数据文件、日志消息、作者信息、日期以及其他用来重建项目任意版本或分支的信息。

git原子对象类型：

- 块：每一个版本的文件数据，但不包含任何关于这个文件的元数据或是文件名等
- 目录树：记录块标识符、路径名以及在一层目录里的所有文件的元数据；并可以递归引用其他子树或是目录树，以形成完整的层次结构
- 提交：保存版本库的每一次变化的元数据；它是针对于每一个目录树的，因而使目录树对象可以捕获版本库的状态
- 标签：对以上的对象进行合理的命名，但通常是针对提交对象；同对哈希值：键值
- 其他：对象的压缩会存储在打包文件里，而打包文件也是对象库的一部分

索引：
临时的、动态的二进制文件，描述整个版本库的目录结构。具体来说是，索引捕捉某个时刻、某个版本的项目状态；而项目的状态可以用一个（棵）提交和目录树来表示。

1. 通过执行git命令可以在索引中暂存变更，变更常是添加、删除或是修改文件；索引记录和保存变更直至提交。可以删除或更改索引中的变更。
2. 使推进开发的时间线和提交变更的时间线分离，进而使复杂的版本库状态向可推测的更好状态过渡，形成主线与分支。

内容的名称：
它是全局唯一标识符，文件或是任意大小的块都可以通过仅比较SHA1来判断是否相同；作为对象的名字和索引。

1. git对象库是一个内容寻址的存储系统，对象库的每个对象都有一个唯一的名称；且该名称是针对对象内容应用SHA1得到的SHA1散列值。
2. SHA1的值是一个40 位的十六进制数，可以简化成前缀。

内容的追踪：git不仅仅是VCS，同时还是一个内容追踪系统；其内容追踪主要表现在:

1. git对象库基于对象内容的散列值设置，而不是基于用户的原始文件名或目录名；因而git追踪的是内容而不是文件名，进而理解多个文件副本、其底层的原子对象只有一份、状态的改变决定着块对象的分配。
2. 当文件从一个版本跨越到另一个版本后，git版本库存储每一个版本的文件，而不是它们的差异、只因内容寻址；并且git使用不同散列值的块数据的区别来计算版本的历史。

内容和路径名：git需要维护一个文件列表来组成版本库的内容；然而git并不基于文件名，而是内容。更具体的是，文件名仅是一段区别于文件内容的数据。

- 文件名和目录名源于底层的文件系统，git记录每一个路径名以确保重建文件和目录；而文件和目录是由散列值来索引的。比如在创建一个工作目录时，git会将块数据（索引）放在路径名为XX的地方；文件系统根据该方式来创建。
- git的物理布局并不是仿于文件目录结构，相反是由完全不同的结构来重建用户的原始布局。
- 使索引和传统数据库的数据 分离。
  表1 数据库对比

打包文件：它是针对内容寻址的一种高效的存储机制。一个打包文件的创建，实质是存储一个文件的整个版本并以及用来构造其他版本的相似文件的差异。

1. 定位 内容非常相似的全部文件，然后为其中的一个 存储整个内容。
2. 计算 相似文件之间的差异，并且只存储差异于包里。
3. 内容驱动下，git可以在版本库里的任意文件间计算差异，并根据足够的相似来产生良好的数据压缩，并构造一系列的差异文件。
4. 维护打包文件中的每个完整文件（包括完整内容的文件和通过差异重建出来的文件）的原始块的SHA1。










